# Test info

- Name: Login and add all employees from file Excel
- Location: /__w/playwrightDemo-ts/playwrightDemo-ts/tests/addEmployee.spec.ts:53:5

# Error details

```
Error: Timed out 5000ms waiting for expect(locator).toBeVisible()

Locator: getByRole('heading', { name: 'Personal Details' })
Expected: visible
Received: <element(s) not found>
Call log:
  - expect.toBeVisible with timeout 5000ms
  - waiting for getByRole('heading', { name: 'Personal Details' })

    at /__w/playwrightDemo-ts/playwrightDemo-ts/tests/addEmployee.spec.ts:74:77
    at /__w/playwrightDemo-ts/playwrightDemo-ts/tests/addEmployee.spec.ts:67:5
```

# Page snapshot

```yaml
- complementary:
  - navigation "Sidepanel":
    - link "client brand banner":
      - /url: https://www.orangehrm.com/
      - img "client brand banner"
    - textbox "Search"
    - button ""
    - separator
    - list:
      - listitem:
        - link "Admin":
          - /url: /web/index.php/admin/viewAdminModule
      - listitem:
        - link "PIM":
          - /url: /web/index.php/pim/viewPimModule
      - listitem:
        - link "Leave":
          - /url: /web/index.php/leave/viewLeaveModule
      - listitem:
        - link "Time":
          - /url: /web/index.php/time/viewTimeModule
      - listitem:
        - link "Recruitment":
          - /url: /web/index.php/recruitment/viewRecruitmentModule
      - listitem:
        - link "My Info":
          - /url: /web/index.php/pim/viewMyDetails
      - listitem:
        - link "Performance":
          - /url: /web/index.php/performance/viewPerformanceModule
      - listitem:
        - link "Dashboard":
          - /url: /web/index.php/dashboard/index
      - listitem:
        - link "Directory":
          - /url: /web/index.php/directory/viewDirectory
      - listitem:
        - link "Maintenance":
          - /url: /web/index.php/maintenance/viewMaintenanceModule
      - listitem:
        - link "Claim":
          - /url: /web/index.php/claim/viewClaimModule
          - img
          - text: Claim
      - listitem:
        - link "Buzz":
          - /url: /web/index.php/buzz/viewBuzz
- banner:
  - heading "PIM" [level=6]
  - link "Upgrade":
    - /url: https://orangehrm.com/open-source/upgrade-to-advanced
    - button "Upgrade"
  - list:
    - listitem:
      - img "profile picture"
      - paragraph: manda user
      - text: 
  - navigation "Topbar Menu":
    - list:
      - listitem: Configuration 
      - listitem:
        - link "Employee List":
          - /url: "#"
      - listitem:
        - link "Add Employee":
          - /url: "#"
      - listitem:
        - link "Reports":
          - /url: "#"
      - button ""
- heading "Add Employee" [level=6]
- separator
- button "Choose File"
- img "profile picture"
- button ""
- paragraph: "Accepts jpg, .png, .gif up to 1MB. Recommended dimensions: 200px X 200px"
- text: Employee Full Name*
- textbox "First Name": Malice
- textbox "Middle Name": Dev
- textbox "Last Name": Jef
- text: Employee Id
- textbox: "0485"
- text: Employee Id already exists
- separator
- paragraph: Create Login Details
- checkbox
- separator
- paragraph: "* Required"
- button "Cancel"
- button "Save"
- paragraph: OrangeHRM OS 5.7
- paragraph:
  - text: © 2005 - 2025
  - link "OrangeHRM, Inc":
    - /url: http://www.orangehrm.com
  - text: . All rights reserved.
```

# Test source

```ts
   1 | import { test, expect } from "@playwright/test";
   2 | import ExcelUtils from "../src/utils/ExcelUtils";
   3 | import { LoginData } from "../src/interfaces/LoginData"; // Importation de l'interface LoginData
   4 | import { EmployeeData } from "../src/interfaces/EmployeeData"; // Importation de l'interface EmployeeData
   5 | import LoginPagexcls from "../src/page-objects/loginPage/LoginPagexcls";
   6 | import PimPage from "../src/page-objects/loginPage/PimPage";
   7 |
   8 | // const loginData = ExcelUtils.getSheetData<LoginData>('Login')[0];
   9 | // const employeesData = ExcelUtils.getSheetData<EmployeeData>('Employees');
  10 |
  11 | // à revoir
  12 | const loginData = ExcelUtils.getLoginData()[0];
  13 | const employeesData = ExcelUtils.getEmployeeData()[0]; //  pour la premiére ligne
  14 |
  15 | test("Login and add employees from Excel", async ({ page }) => {
  16 |   const loginPagexcls = new LoginPagexcls(page);
  17 |   const pimPage = new PimPage(page);
  18 |
  19 |   await test.step("Login to OrangeHRM", async () => {
  20 |     //await loginPagexcls.login(loginData.username, loginData.password);
  21 |     //await expect(page).toHaveURL(/dashboard/);
  22 |
  23 |     // à revoir
  24 |     await page.goto("/");
  25 |     await loginPagexcls.login(loginData.username, loginData.password);
  26 |     await expect(page).toHaveURL(/dashboard/);
  27 |   });
  28 |
  29 |   // for (const employee of employeesData) {
  30 |   // await test.step(`Add employee: ${employee.firstName} ${employee.lastName}`, async () => {
  31 |   // await pimPage.navigateToAddEmployee();
  32 |   // await pimPage.createEmployee(employee.firstName, employee.middleName ?? '', employee.lastName, employee.employeeId);
  33 |   // await expect(page.locator('.orangehrm-header-container')).toContainText('Personal Details');
  34 |   //  await expect(page.getByRole('heading', { name: 'Personal Details' })).toBeVisible();
  35 |   //  await expect(page.locator('h6')).toHaveText('Personal Details'); // ne fonctionne pas
  36 |   // });
  37 |   // }
  38 |   // à revoir
  39 |   await test.step("Ajouter un employé", async () => {
  40 |     await pimPage.navigateToAddEmployee();
  41 |     await pimPage.createEmployee(
  42 |       employeesData.firstName,
  43 |       employeesData.middleName || "",
  44 |       employeesData.lastName,
  45 |       //employeesData.employeeId
  46 |     );
  47 |     await expect(
  48 |       page.getByRole("heading", { name: "Personal Details" })
  49 |     ).toBeVisible();
  50 |   });
  51 | });
  52 |
  53 | test('Login and add all employees from file Excel', async ({ page }) => {
  54 |   const loginData = ExcelUtils.getLoginData()[0];
  55 |   const employeesData = ExcelUtils.getEmployeeData();
  56 |
  57 |   const loginPage = new LoginPagexcls(page);
  58 |   const pimPage   = new PimPage(page);
  59 |
  60 |   await test.step('Login to OrangeHRM', async () => {
  61 |     await page.goto('/');
  62 |     await loginPage.login(loginData.username, loginData.password);
  63 |     await expect(page).toHaveURL(/dashboard/);
  64 |   });
  65 |
  66 |   for (const emp of employeesData) {
  67 |     await test.step(`Ajouter l'employé : ${emp.firstName} ${emp.lastName}`, async () => {
  68 |       await pimPage.navigateToAddEmployee();
  69 |       await pimPage.createEmployee(
  70 |         emp.firstName,
  71 |         emp.middleName || '',
  72 |         emp.lastName
  73 |       );
> 74 |       await expect(page.getByRole('heading', { name: 'Personal Details' })).toBeVisible();
     |                                                                             ^ Error: Timed out 5000ms waiting for expect(locator).toBeVisible()
  75 |     });
  76 |   }
  77 | });
  78 |
```